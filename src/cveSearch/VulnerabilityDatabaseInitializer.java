package cveSearch;

import java.io.File;
import java.io.IOException;
import java.util.Optional;

import org.junit.jupiter.api.Test;

public class VulnerabilityDatabaseInitializer {

	// TODO: Make eclipse recognize environment variables
	private final String env_mongod = "/usr/bin/mongod"; // "MONGOD"
	private String database_location = "VulnerabilityData";

	public static File createDirectory(String directoryPath) throws IOException {
		File dir = new File(directoryPath);
		if (dir.exists()) {
			return dir;
		}
		if (dir.mkdirs()) {
			return dir;
		}
		throw new IOException("Failed to create directory '" + dir.getAbsolutePath() + "' for an unknown reason.");
	}

	private void startDatabase() throws IOException {
		createDirectory(database_location);
		
		ProcessBuilder pb = new ProcessBuilder();
		pb.command(env_mongod, "--dbpath", "database_location");

		Process p;
		try {
			p = pb.start();
			System.out.println(p.isAlive());
			p.destroyForcibly();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

	@Test
	public void execute() throws IOException {
		startDatabase();
	}

}
