package vulnerabilitySearch;

import java.util.ArrayList;

/**
 * A class for representing search results for the vulnerability search
 * 
 * @param vendorName
 *            the name of the product's vendor to search for
 * @param productName
 *            the name of the project/product to search for
 * @param cveIDs
 *            a list of found CVE's for this project with their CVE ID's.
 */
class VulnerabilitySearchResult implements Comparable<VulnerabilitySearchResult> {

	private String vendorName;
	private String productName;
	private ArrayList<String> cveIDs;

	public VulnerabilitySearchResult(String vendorName, String productName, ArrayList<String> cves) {
		this.vendorName = vendorName;
		this.productName = productName;
		this.cveIDs = cves;
	}

	@Override
	public int compareTo(VulnerabilitySearchResult vulnerabilityRes) {
		int firstListSize = this.cveIDs.size();
		int secondListSize = vulnerabilityRes.getCveIDs().size();
		if (firstListSize != secondListSize)
			return 0;

		boolean allVulnerabilitiesMatch = false;
		int counter = 0;

		for (String cveId : this.cveIDs) {
			if (vulnerabilityRes.getCveIDs().contains(cveId))
				counter++;
		}

		if (counter == firstListSize)
			allVulnerabilitiesMatch = true;

		return ((vulnerabilityRes.getProductName().equals(this.productName)) && allVulnerabilitiesMatch) ? 1 : 0;
	}

	public String getProductName() {
		return productName;
	}

	public String getVendorName() {
		return vendorName;
	}

	public ArrayList<String> getCveIDs() {
		return cveIDs;
	}

	@Override
	public String toString() {
		return productName + cveIDs.toString();
	}

}